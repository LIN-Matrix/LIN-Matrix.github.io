# day4 (4.17)

1. 梳理论文大纲

[filename](../../asserts/0417/1.md ':include :type=markdown')

2. 参考师兄的博士论文第四章

### 2.X ArceOS 网络子系统 axnet 组件分析

在 ArceOS 的组件化体系中，网络功能由独立的 `axnet` 组件实现。该组件不仅承担了网络协议栈与底层网卡驱动之间的桥接职责，还面向应用层提供了统一的套接字（socket）接口，形成了完整的网络服务链路。

为适应不同应用场景下的性能与资源要求，`axnet` 支持多种网络协议栈的接入，目前集成了两种在嵌入式和实时系统中广泛使用的轻量级协议栈：**smoltcp**（基于 Rust 实现）和 **lwIP**（基于 C 语言实现）。这两个协议栈以组件化模块的形式存在，分别暴露出标准化的网卡设备抽象接口。开发者仅需在 `axdriver` 模块中实现该接口，即可将底层驱动与协议栈解耦组合，从而实现协议栈与物理设备之间的透明对接。

在此基础上，`axnet` 对两类协议栈的套接字接口进行了统一封装，提供了接近 POSIX 标准的 API 风格。主要支持的接口包括 `connect`、`bind`、`listen`、`accept`、`send` 和 `recv` 等 TCP 通用操作。同时，也支持 UDP 套接字、DNS 域名解析等基础网络功能，增强了组件的适用范围与可扩展性。

值得注意的是，为了尽可能提升网络处理性能，`axnet` 当前采用**基于轮询的访问模式**。在每次应用层调用套接字操作后，系统会主动轮询网卡状态：若检测到接收到的数据包，则立即将其上送协议栈以推进状态机处理流程；同时，也会检查协议栈中的发送缓冲区，并将待发送数据通过网卡发出。这种机制在无中断控制器或资源受限场景下具有较好的实时性和确定性。

此外，ArceOS 在数据包的收发路径上也引入了**零拷贝优化机制**。在数据接收过程中，系统预先为网卡分配一组缓冲区并注册至其接收队列，当数据包到达后，可直接传递缓冲区至协议栈处理，避免中间数据复制操作。处理完成后，缓冲区被复用回接收队列，进一步减少内存碎片和提升处理效率。

综上，`axnet` 模块以组件化的方式集成协议栈、网卡驱动和 POSIX 风格接口，并通过零拷贝优化与轮询机制提升数据处理性能，为后续宏内核模块（如 syscall 支持）中的网络功能扩展提供了良好基础。
